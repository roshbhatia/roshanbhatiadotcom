<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Projects - Roshan Bhatia</title>
  <link rel="stylesheet" href="https://fx.hot.page/style">
  <link rel="stylesheet" href="../assets/css/style.css">
  <script src="https://unpkg.com/htmx.org@1.9.10" defer></script>
  <script src="https://unpkg.com/alpinejs@3.13.3" defer></script>
</head>
<body>
  <div class="fx-content page-transition">
    <h2>Projects</h2>
    <p>These are selected projects tagged with the "internal" topic on my GitHub.</p>
    
    <div id="projects-container" x-data="projectsData()">
      <div class="fx-loading htmx-indicator">
        Loading projects...
      </div>
      
      <template x-if="loading">
        <div class="fx-loading">
          Loading projects from GitHub...
        </div>
      </template>
      
      <template x-if="error">
        <div class="fx-error">
          <p x-text="error"></p>
          <p>You can still view all projects on <a href="https://github.com/roshbhatia?tab=repositories" target="_blank">GitHub</a>.</p>
        </div>
      </template>
      
      <template x-if="!loading && !error && projects.length === 0">
        <div class="fx-empty">
          <p>No projects with the "internal" topic found.</p>
          <p>You can view all projects on <a href="https://github.com/roshbhatia?tab=repositories" target="_blank">GitHub</a>.</p>
        </div>
      </template>
      
      <div class="fx-grid">
        <template x-for="project in projects" :key="project.id">
          <a :href="project.html_url" target="_blank" class="fx-project-card">
            <h3 x-text="project.name"></h3>
            <p x-text="project.description || 'No description available'"></p>
            
            <div class="fx-tags">
              <span class="language" x-text="project.language || 'Unknown'"></span>
            </div>
            
            <div class="fx-project-meta">
              <span>
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                  <polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"></polygon>
                </svg>
                <span x-text="project.stargazers_count"></span>
              </span>
              <span>
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                  <path d="M21 12a9 9 0 0 0-9-9 9 9 0 0 0-9 9c0 3.6 2.4 6.9 5.8 8.7L12 24l3.2-3.3C18.6 18.9 21 15.6 21 12z"></path>
                </svg>
                <span x-text="project.forks_count"></span>
              </span>
              <span class="fx-updated">
                <span>Updated: </span>
                <span x-text="formatDate(project.updated_at)"></span>
              </span>
            </div>
          </a>
        </template>
      </div>
    </div>
  </div>

  <script>
    function projectsData() {
      return {
        projects: [],
        loading: true,
        error: null,
        
        init() {
          this.fetchProjects();
        },
        
        async fetchProjects() {
          try {
            const username = 'roshbhatia'; // Your GitHub username
            const response = await fetch(`https://api.github.com/users/${username}/repos?per_page=100`);
            
            if (!response.ok) {
              throw new Error(`GitHub API returned ${response.status}`);
            }
            
            const data = await response.json();
            
            // Filter repositories with the "internal" topic
            this.projects = data.filter(repo => {
              if (!repo.topics || repo.topics.length === 0) return false;
              return repo.topics.includes('internal');
            });
            
            this.loading = false;
          } catch (err) {
            console.error('Error fetching projects:', err);
            this.error = 'Failed to load projects from GitHub. Please try again later.';
            this.loading = false;
          }
        },
        
        formatDate(dateString) {
          const options = { year: 'numeric', month: 'short', day: 'numeric' };
          return new Date(dateString).toLocaleDateString(undefined, options);
        }
      };
    }
  </script>
</body>
</html>